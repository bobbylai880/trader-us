# AI Trader Assist

> **åŠè‡ªåŠ¨åŒ–ç¾è‚¡ç›˜å‰å†³ç­–ç³»ç»Ÿ** â€” åŸºäºé‡åŒ–åˆ†æä¸ LLM æ¨ç†çš„äººæœºååŒæŠ•èµ„åŠ©æ‰‹

âš ï¸ **å…è´£å£°æ˜**ï¼šæœ¬é¡¹ç›®ä»…ç”¨äºç ”ç©¶ä¸æ•™å­¦ï¼Œä¸è¿æ¥ä»»ä½•åˆ¸å•†ç³»ç»Ÿï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚è¯·åœ¨äººå·¥å¤æ ¸åæ‰§è¡Œæ‰€æœ‰äº¤æ˜“ã€‚

---

## ä¸€ã€ç³»ç»ŸåŸç†

### 1.1 æ ¸å¿ƒç†å¿µ

AI Trader Assist é‡‡ç”¨ **"é‡åŒ–ç­›é€‰ + LLM è§£è¯» + äººå·¥å†³ç­–"** çš„ä¸‰å±‚æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        äººå·¥å†³ç­–å±‚                                â”‚
â”‚              å¤æ ¸å»ºè®® â†’ æ‰§è¡Œäº¤æ˜“ â†’ è®°å½•æ“ä½œ â†’ å¤ç›˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–²
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        LLM è§£è¯»å±‚                                â”‚
â”‚     å¸‚åœºè§£è¯» â†’ æ¿å—åˆ†æ â†’ ä¸ªè‚¡åˆ†ç±» â†’ ä»“ä½å®¡æŸ¥ â†’ æŠ¥å‘Šç”Ÿæˆ         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–²
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        é‡åŒ–ç­›é€‰å±‚                                â”‚
â”‚        æ•°æ®é‡‡é›† â†’ ç‰¹å¾å·¥ç¨‹ â†’ æŠ€æœ¯æŒ‡æ ‡ â†’ é£é™©è¯„ä¼° â†’ è¯„åˆ†æ’åº      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 è®¾è®¡åŸåˆ™

| åŸåˆ™ | è¯´æ˜ |
|------|------|
| **äººæœºååŒ** | ç³»ç»Ÿæä¾›å»ºè®®ï¼Œäººå·¥åšæœ€ç»ˆå†³ç­– |
| **é£æ§ä¼˜å…ˆ** | ç¡¬æ€§çº¦æŸä¸å¯è¿åï¼ˆæœ€å¤§ä»“ä½ã€å•åªä¸Šé™ã€æ­¢æŸå¼ºåˆ¶ï¼‰ |
| **æ•°æ®é©±åŠ¨** | æ‰€æœ‰å»ºè®®åŸºäºé‡åŒ–æŒ‡æ ‡ï¼Œè€Œéä¸»è§‚åˆ¤æ–­ |
| **å¯è¿½æº¯** | å®Œæ•´è®°å½•æ¯æ—¥åˆ†æè¿‡ç¨‹ï¼Œä¾¿äºå¤ç›˜ä¼˜åŒ– |

### 1.3 å†³ç­–é€»è¾‘

```
è¾“å…¥: å¸‚åœºæ•°æ® + æŒä»“çŠ¶æ€ + é£æ§å‚æ•°
  â”‚
  â”œâ”€â–º å®è§‚é£é™©è¯„ä¼°
  â”‚     â””â”€â–º VIX Z-score â†’ é£é™©ç­‰çº§ â†’ ç›®æ ‡ä»“ä½ä¸Šé™
  â”‚
  â”œâ”€â–º æ¿å—ç›¸å¯¹å¼ºå¼±
  â”‚     â””â”€â–º 11ä¸ªSPDRæ¿å— â†’ é¢†å…ˆ/è½å â†’ è¶…é…/ä½é…å»ºè®®
  â”‚
  â”œâ”€â–º ä¸ªè‚¡é‡åŒ–è¯„åˆ†
  â”‚     â””â”€â–º è¶‹åŠ¿ + åŠ¨é‡ + ç›¸å¯¹å¼ºåº¦ + æ–°é—»æƒ…ç»ª â†’ ç»¼åˆè¯„åˆ†
  â”‚
  â”œâ”€â–º ä»“ä½è§„åˆ’
  â”‚     â””â”€â–º ATRæ­¢æŸ â†’ é£é™©é¢„ç®— â†’ å»ºè®®è‚¡æ•°
  â”‚
  â””â”€â–º è¾“å‡º: æ“ä½œæ¸…å• (ä¹°å…¥/å‡ä»“/è§‚æœ›)
```

---

## äºŒã€ç³»ç»Ÿæ¶æ„

### 2.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·äº¤äº’å±‚                                â”‚
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚    â”‚   Skills    â”‚    â”‚  Subagents  â”‚    â”‚    CLI      â”‚        â”‚
â”‚    â”‚ /market-scanâ”‚    â”‚ @data-analystâ”‚   â”‚ run_daily   â”‚        â”‚
â”‚    â”‚ /stock-analysisâ”‚ â”‚ @risk-managerâ”‚   â”‚ record_ops  â”‚        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç¼–æ’å±‚ (Orchestrator)                      â”‚
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚    â”‚              trading-orchestrator                    â”‚      â”‚
â”‚    â”‚         æ„å›¾è¯†åˆ« â†’ ä»»åŠ¡åˆ†å‘ â†’ ç»“æœæ±‡æ€»               â”‚      â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                   â–¼                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Data Analyst  â”‚  â”‚  Risk Manager   â”‚  â”‚ Portfolio Mgr   â”‚
â”‚   æ•°æ®é‡‡é›†åˆ†æ   â”‚  â”‚   é£é™©è¯„ä¼°æ§åˆ¶   â”‚  â”‚   æŒä»“ç®¡ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MCP Tools å±‚                               â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ ä»·æ ¼å·¥å…·  â”‚ â”‚ æ–°é—»å·¥å…·  â”‚ â”‚ æŒä»“å·¥å…·  â”‚ â”‚ åˆ†æå·¥å…·  â”‚           â”‚
â”‚  â”‚get_price â”‚ â”‚ get_news â”‚ â”‚get_portfolioâ”‚ â”‚calc_indicatorsâ”‚      â”‚
â”‚  â”‚get_historyâ”‚ â”‚get_macro â”‚ â”‚save_operationâ”‚â”‚score_stocksâ”‚        â”‚
â”‚  â”‚get_quotesâ”‚ â”‚ get_pcr  â”‚ â”‚update_positionsâ”‚generate_ordersâ”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ ¸å¿ƒæ¨¡å—å±‚                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚data_collectorâ”‚  â”‚feature_engineâ”‚  â”‚decision_engineâ”‚          â”‚
â”‚  â”‚  yf_client   â”‚  â”‚  indicators  â”‚  â”‚ stock_scoring â”‚          â”‚
â”‚  â”‚ fred_client  â”‚  â”‚trend_featuresâ”‚  â”‚              â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ risk_engine  â”‚  â”‚position_sizerâ”‚  â”‚portfolio_mgr â”‚          â”‚
â”‚  â”‚ macro_engine â”‚  â”‚    sizer     â”‚  â”‚   state      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å­˜å‚¨å±‚                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   configs/  â”‚  â”‚   storage/  â”‚  â”‚    cache/   â”‚             â”‚
â”‚  â”‚  base.json  â”‚  â”‚positions.jsonâ”‚ â”‚   yf/*.pkl  â”‚             â”‚
â”‚  â”‚  prompts/   â”‚  â”‚operations.jsonlâ”‚ fred/*.json â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ•°æ®æµ

```
Yahoo Finance / FRED
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå§‹è¡Œæƒ…æ•°æ®  â”‚ â”€â”€â–º â”‚   ç‰¹å¾å·¥ç¨‹    â”‚ â”€â”€â–º â”‚   é‡åŒ–è¯„åˆ†    â”‚
â”‚ OHLCV, News   â”‚     â”‚ RSI,MACD,ATR  â”‚     â”‚ 0-100 ç»¼åˆåˆ†  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
                                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LLM åˆ†æ     â”‚ â—„â”€â”€ â”‚   ç‰¹å¾æ±‡æ€»    â”‚ â—„â”€â”€ â”‚   é£é™©è¯„ä¼°    â”‚
â”‚ 5é˜¶æ®µæ¨ç†     â”‚     â”‚ JSON Payload  â”‚     â”‚ VIX, PCR     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ“ä½œå»ºè®®     â”‚ â”€â”€â–º â”‚   ä»“ä½è®¡ç®—    â”‚ â”€â”€â–º â”‚   æŠ¥å‘Šè¾“å‡º    â”‚
â”‚ Buy/Hold/Sell â”‚     â”‚ ATRæ­¢æŸæ­¢ç›ˆ   â”‚     â”‚ MD + JSON    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æ ¸å¿ƒé€»è¾‘

### 3.1 é£é™©è¯„ä¼°æ¨¡å‹

åŸºäº VIX Z-score çš„åŠ¨æ€é£é™©ç­‰çº§ï¼š

```python
VIX_Z = (å½“å‰VIX - 60æ—¥å‡å€¼) / 60æ—¥æ ‡å‡†å·®

if VIX_Z > 2.0:    é£é™©ç­‰çº§ = â›” æç«¯é£é™©, ç›®æ ‡ä»“ä½ â‰¤ 30%
elif VIX_Z > 1.5:  é£é™©ç­‰çº§ = ğŸ”´ é«˜é£é™©,   ç›®æ ‡ä»“ä½ â‰¤ 50%
elif VIX_Z > 0:    é£é™©ç­‰çº§ = ğŸŸ¡ ä¸­ç­‰é£é™©, ç›®æ ‡ä»“ä½ â‰¤ 70%
else:              é£é™©ç­‰çº§ = ğŸŸ¢ ä½é£é™©,   ç›®æ ‡ä»“ä½ â‰¤ 85%
```

### 3.2 ä¸ªè‚¡è¯„åˆ†æ¨¡å‹

ç»¼åˆè¯„åˆ† = åŠ æƒå¹³å‡ (0-100åˆ†)ï¼š

| å› å­ | æƒé‡ | è®¡ç®—æ–¹æ³• |
|------|------|----------|
| è¶‹åŠ¿å¼ºåº¦ | 25% | ä»·æ ¼ vs SMA20/50 ä½ç½® |
| åŠ¨é‡ä¿¡å· | 25% | RSI + MACD ç»„åˆ |
| ç›¸å¯¹å¼ºåº¦ | 20% | ä¸ªè‚¡æ¶¨å¹… vs SPY |
| æ–°é—»æƒ…ç»ª | 15% | å…³é”®è¯æƒ…ç»ªåˆ†æ |
| æˆäº¤é‡ | 15% | ç›¸å¯¹æˆäº¤é‡æ¯”ç‡ |

### 3.3 ä»“ä½è®¡ç®—æ¨¡å‹

åŸºäº ATR çš„é£é™©æ§åˆ¶ä»“ä½è®¡ç®—ï¼š

```python
# æ­¢æŸæ­¢ç›ˆ
æ­¢æŸä»· = å…¥åœºä»· - (ATR Ã— 1.5)   # k1_stop
æ­¢ç›ˆä»· = å…¥åœºä»· + (ATR Ã— 2.5)   # k2_target
é£é™©æ”¶ç›Šæ¯” = 1 : 1.67

# ä»“ä½è®¡ç®—
å¯ç”¨é¢„ç®— = min(
    æ€»æƒç›Š Ã— (æœ€å¤§ä»“ä½ - å½“å‰ä»“ä½),
    æ€»æƒç›Š Ã— å•åªä¸Šé™ - å·²æœ‰æŒä»“,
    ç°é‡‘ä½™é¢
)
å»ºè®®è‚¡æ•° = floor(å¯ç”¨é¢„ç®— / å½“å‰ä»·æ ¼)
```

### 3.4 LLM 5é˜¶æ®µæ¨ç†

```
é˜¶æ®µ1: å¸‚åœºè§£è¯» (market_analyzer)
    è¾“å…¥: VIX, PCR, æŒ‡æ•°æ¶¨è·Œ, å®è§‚æŒ‡æ ‡
    è¾“å‡º: risk_level, bias, drivers

é˜¶æ®µ2: æ¿å—åˆ†æ (sector_analyzer)
    è¾“å…¥: 11ä¸ªæ¿å—ç‰¹å¾, ç›¸å¯¹å¼ºåº¦
    è¾“å‡º: leading, lagging, focus_points

é˜¶æ®µ3: ä¸ªè‚¡åˆ†ç±» (stock_classifier)
    è¾“å…¥: ä¸ªè‚¡ç‰¹å¾, è¶‹åŠ¿, æ–°é—»
    è¾“å‡º: categories (Buy/Hold/Reduce/Avoid)

é˜¶æ®µ4: ä»“ä½å®¡æŸ¥ (exposure_planner)
    è¾“å…¥: å½“å‰æŒä»“, å‰é˜¶æ®µç»“æœ
    è¾“å‡º: allocation_plan, constraints

é˜¶æ®µ5: æŠ¥å‘Šæ•´åˆ (report_composer)
    è¾“å…¥: æ‰€æœ‰å‰é˜¶æ®µç»“æœ
    è¾“å‡º: markdownæŠ¥å‘Š, æ“ä½œæ¸…å•
```

---

## å››ã€å®ç°æ–¹å¼

### 4.1 Agent åŒ–æ¶æ„ (OpenCode é›†æˆ)

ç³»ç»Ÿé‡‡ç”¨ OpenCode Agent/Skill/MCP Tools æ¶æ„ï¼š

#### Agents (5ä¸ª)

| Agent | æ¨¡å¼ | èŒè´£ |
|-------|------|------|
| `trading-orchestrator` | primary | ä¸»ç¼–æ’ï¼Œæ„å›¾è·¯ç”±ï¼Œä»»åŠ¡åˆ†å‘ |
| `trading-data-analyst` | subagent | æ•°æ®é‡‡é›†ï¼ŒæŠ€æœ¯åˆ†æ |
| `trading-risk-manager` | subagent | é£é™©è¯„ä¼°ï¼Œä»“ä½æ§åˆ¶ |
| `trading-portfolio-manager` | subagent | æŒä»“ç®¡ç†ï¼Œæ“ä½œè®°å½• |
| `trading-report-composer` | subagent | æŠ¥å‘Šç”Ÿæˆï¼Œä¿¡æ¯æ•´åˆ |

#### Skills (7ä¸ª)

| Skill | è§¦å‘æ–¹å¼ | åŠŸèƒ½ |
|-------|----------|------|
| `/market-scan` | "å¸‚åœºæ€ä¹ˆæ ·" | å¸‚åœºé£é™©æ‰«æ |
| `/sector-analysis` | "æ¿å—è¡¨ç°" | æ¿å—è½®åŠ¨åˆ†æ |
| `/stock-analysis` | "åˆ†æNVDA" | ä¸ªè‚¡æ·±åº¦åˆ†æ |
| `/position-sizing` | "ä¹°å¤šå°‘è‚¡" | ä»“ä½è®¡ç®— |
| `/daily-report` | "ç”ŸæˆæŠ¥å‘Š" | æ¯æ—¥ç›˜å‰æŠ¥å‘Š |
| `/record-operation` | "è®°å½•äº¤æ˜“" | æ“ä½œå½•å…¥ |
| `/show-portfolio` | "æˆ‘çš„æŒä»“" | æŒä»“æŸ¥è¯¢ |

#### MCP Tools (14ä¸ª)

```
ä»·æ ¼å·¥å…·: get_price, get_history, get_quotes
æ–°é—»å·¥å…·: get_news, get_macro, get_pcr
æŒä»“å·¥å…·: get_portfolio, save_operation, update_positions, get_operations_history
åˆ†æå·¥å…·: calc_indicators, score_stocks, generate_orders
```

### 4.2 ç›®å½•ç»“æ„

```
trader/
â”œâ”€â”€ .opencode/                    # OpenCode é…ç½®
â”‚   â”œâ”€â”€ opencode.json             # Agent + MCP é…ç½®
â”‚   â”œâ”€â”€ agents/                   # 5ä¸ª Agent å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ trading-orchestrator.md
â”‚   â”‚   â”œâ”€â”€ trading-data-analyst.md
â”‚   â”‚   â”œâ”€â”€ trading-risk-manager.md
â”‚   â”‚   â”œâ”€â”€ trading-portfolio-manager.md
â”‚   â”‚   â””â”€â”€ trading-report-composer.md
â”‚   â””â”€â”€ skills/                   # 7ä¸ª Skill å®šä¹‰
â”‚       â”œâ”€â”€ market-scan/SKILL.md
â”‚       â”œâ”€â”€ sector-analysis/SKILL.md
â”‚       â”œâ”€â”€ stock-analysis/SKILL.md
â”‚       â”œâ”€â”€ position-sizing/SKILL.md
â”‚       â”œâ”€â”€ daily-report/SKILL.md
â”‚       â”œâ”€â”€ record-operation/SKILL.md
â”‚       â””â”€â”€ show-portfolio/SKILL.md
â”‚
â”œâ”€â”€ ai_trader_assist/             # Python æ ¸å¿ƒåŒ…
â”‚   â”œâ”€â”€ mcp_server/               # MCP Server (14ä¸ªå·¥å…·)
â”‚   â”‚   â”œâ”€â”€ server.py
â”‚   â”‚   â””â”€â”€ tools/
â”‚   â”‚       â”œâ”€â”€ price_tools.py
â”‚   â”‚       â”œâ”€â”€ news_tools.py
â”‚   â”‚       â”œâ”€â”€ portfolio_tools.py
â”‚   â”‚       â””â”€â”€ analysis_tools.py
â”‚   â”œâ”€â”€ data_collector/           # æ•°æ®é‡‡é›†
â”‚   â”‚   â”œâ”€â”€ yf_client.py          # Yahoo Finance
â”‚   â”‚   â”œâ”€â”€ fred_client.py        # FRED å®è§‚æ•°æ®
â”‚   â”‚   â””â”€â”€ cboe_client.py        # CBOE PCR
â”‚   â”œâ”€â”€ feature_engineering/      # ç‰¹å¾å·¥ç¨‹
â”‚   â”‚   â”œâ”€â”€ indicators.py         # RSI, MACD, ATR
â”‚   â”‚   â”œâ”€â”€ trend_features.py     # è¶‹åŠ¿ç‰¹å¾
â”‚   â”‚   â””â”€â”€ pipeline.py           # ç‰¹å¾æ±‡æ€»
â”‚   â”œâ”€â”€ risk_engine/              # é£é™©å¼•æ“
â”‚   â”‚   â””â”€â”€ macro_engine.py
â”‚   â”œâ”€â”€ decision_engine/          # å†³ç­–å¼•æ“
â”‚   â”‚   â””â”€â”€ stock_scoring.py
â”‚   â”œâ”€â”€ position_sizer/           # ä»“ä½è®¡ç®—
â”‚   â”‚   â””â”€â”€ sizer.py
â”‚   â”œâ”€â”€ portfolio_manager/        # æŒä»“ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ state.py
â”‚   â”‚   â””â”€â”€ positions.py
â”‚   â”œâ”€â”€ llm/                      # LLM å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ client.py
â”‚   â”‚   â””â”€â”€ analyzer.py
â”‚   â”œâ”€â”€ llm_operators/            # LLM ç®—å­
â”‚   â”‚   â”œâ”€â”€ market_analyzer.py
â”‚   â”‚   â”œâ”€â”€ sector_analyzer.py
â”‚   â”‚   â”œâ”€â”€ stock_classifier.py
â”‚   â”‚   â”œâ”€â”€ exposure_planner.py
â”‚   â”‚   â””â”€â”€ report_composer.py
â”‚   â””â”€â”€ jobs/                     # è°ƒåº¦è„šæœ¬
â”‚       â”œâ”€â”€ run_daily.py
â”‚       â”œâ”€â”€ record_operations.py
â”‚       â””â”€â”€ report_portfolio.py
â”‚
â”œâ”€â”€ configs/                      # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ base.json                 # ä¸»é…ç½®
â”‚   â””â”€â”€ prompts/                  # LLM æç¤ºè¯
â”‚
â”œâ”€â”€ storage/                      # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ positions.json            # å½“å‰æŒä»“
â”‚   â”œâ”€â”€ operations.jsonl          # æ“ä½œæ—¥å¿—
â”‚   â”œâ”€â”€ cache/                    # æ•°æ®ç¼“å­˜
â”‚   â””â”€â”€ daily_*/                  # æ¯æ—¥è¾“å‡º
â”‚
â””â”€â”€ tests/                        # æµ‹è¯•ç”¨ä¾‹
```

---

## äº”ã€å¿«é€Ÿå¼€å§‹

### 5.1 ç¯å¢ƒå‡†å¤‡

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv .venv
source .venv/bin/activate

# 2. å®‰è£…ä¾èµ–
pip install -r requirements.txt
pip install "mcp[cli]"

# 3. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ DEEPSEEK_API_KEY
```

### 5.2 OpenCode ä½¿ç”¨

```bash
# å¯åŠ¨ OpenCode
opencode

# ä½¿ç”¨ Skills
/market-scan              # å¸‚åœºæ‰«æ
/stock-analysis NVDA      # åˆ†æè‹±ä¼Ÿè¾¾
/show-portfolio           # æŸ¥çœ‹æŒä»“

# ä½¿ç”¨ Subagents
@trading-data-analyst è·å– SPY ä»·æ ¼
@trading-risk-manager è¯„ä¼°å¸‚åœºé£é™©
```

### 5.3 CLI ä½¿ç”¨

```bash
# è¿è¡Œæ¯æ—¥åˆ†æ
python -m ai_trader_assist.jobs.run_daily \
  --config configs/base.json \
  --output-dir storage/daily_$(date +%F)

# è®°å½•æ“ä½œ
python -m ai_trader_assist.jobs.record_operations \
  --config configs/base.json

# ç”ŸæˆæŒä»“æŠ¥å‘Š
python -m ai_trader_assist.jobs.report_portfolio \
  --config configs/base.json
```

---

## å…­ã€é…ç½®è¯´æ˜

### 6.1 æ ¸å¿ƒé…ç½® (`configs/base.json`)

```json
{
  "universe": {
    "indices": ["SPY", "QQQ", "DIA", "IWM"],
    "sectors": ["XLK", "XLF", "XLV", "XLE", ...],
    "watchlist": ["NVDA", "AAPL", "MSFT", "AMZN", "META", "AMD"]
  },
  "limits": {
    "max_exposure": 0.85,      // æœ€å¤§æ€»ä»“ä½ 85%
    "max_single_weight": 0.25, // å•åªä¸Šé™ 25%
    "min_ticket": 1000         // æœ€å°äº¤æ˜“é‡‘é¢
  },
  "sizer": {
    "k1_stop": 1.5,            // æ­¢æŸ = 1.5 ATR
    "k2_target": 2.5           // æ­¢ç›ˆ = 2.5 ATR
  }
}
```

### 6.2 é£æ§è§„åˆ™ï¼ˆç¡¬æ€§çº¦æŸï¼‰

| è§„åˆ™ | é˜ˆå€¼ | è§¦å‘åŠ¨ä½œ |
|------|------|----------|
| æœ€å¤§æ€»ä»“ä½ | 85% | ç¦æ­¢æ–°ä¹°å…¥ |
| å•åªä¸Šé™ | 25% | æŒ‰ä¸Šé™æˆªæ–­ |
| æœ€å°äº¤æ˜“ | $1000 | è·³è¿‡äº¤æ˜“ |
| VIX æç«¯ | Z-score > 2 | ç¦æ­¢æ–°ä»“ä½ |
| æ­¢æŸå¼ºåˆ¶ | å¿…é¡»è®¾ç½® | å¦åˆ™æ‹’ç»ä¹°å…¥ |

---

## ä¸ƒã€æµ‹è¯•éªŒè¯

### 7.1 è¿è¡Œæµ‹è¯•

```bash
# å•å…ƒæµ‹è¯•
pytest tests -q

# ç«¯åˆ°ç«¯æµ‹è¯•
python -m ai_trader_assist.jobs.run_daily \
  --config configs/base.json \
  --date 2025-10-27 \
  --output-dir storage/test_run
```

### 7.2 æµ‹è¯•è¦†ç›–

| æ¨¡å— | æµ‹è¯•æ–‡ä»¶ | éªŒè¯å†…å®¹ |
|------|----------|----------|
| æŒä»“è®¡ç®— | `test_positions.py` | ä¹°å…¥/å–å‡º/å‡ä»·è®¡ç®— |
| ä»“ä½è§„åˆ’ | `test_sizer.py` | ATRæ­¢æŸã€é¢„ç®—åˆ†é… |
| å®è§‚é£é™© | `test_macro_engine.py` | é£é™©ç­‰çº§åˆ¤å®š |

---

## å…«ã€æ‰©å±•æŒ‡å—

### 8.1 æ·»åŠ æ–°æ•°æ®æº

```python
# 1. åˆ›å»ºå®¢æˆ·ç«¯ (data_collector/new_source.py)
class NewSourceClient:
    def fetch_data(self, symbol: str) -> Dict:
        ...

# 2. æ³¨å†Œ MCP å·¥å…· (mcp_server/tools/new_tools.py)
@mcp.tool()
def get_new_data(symbol: str) -> Dict:
    ...

# 3. é›†æˆåˆ°ç‰¹å¾æµæ°´çº¿ (feature_engineering/pipeline.py)
```

### 8.2 æ·»åŠ æ–°æŠ€æœ¯æŒ‡æ ‡

```python
# feature_engineering/indicators.py
def new_indicator(series: pd.Series, window: int = 14) -> pd.Series:
    """è®¡ç®—æ–°æŒ‡æ ‡"""
    ...
```

### 8.3 æ·»åŠ æ–° Skill

```markdown
# .opencode/skills/new-skill/SKILL.md
---
name: new-skill
description: æ–°åŠŸèƒ½æè¿°ã€‚è§¦å‘è¯ï¼šå…³é”®è¯1ã€å…³é”®è¯2
---

# New Skill

## æ‰§è¡Œæ­¥éª¤
1. ...
2. ...
```

---

## ä¹ã€æ•…éšœæ’æŸ¥

| ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|
| MCP Server åŠ è½½å¤±è´¥ | ç¼ºå°‘ä¾èµ– | `pip install "mcp[cli]"` |
| yfinance è¯·æ±‚å¤±è´¥ | ç½‘ç»œ/é™æµ | å¯ç”¨ç¼“å­˜ã€å‡å°‘é¢‘ç‡ |
| FRED è¿”å› 403 | API Key æ— æ•ˆ | æ£€æŸ¥ `.env` é…ç½® |
| Agent ä¸å¯è§ | é…ç½®ä½ç½®é”™è¯¯ | ç¡®ä¿é…ç½®åœ¨ `.opencode/` |
| ä»“ä½è®¡ç®—å¼‚å¸¸ | æ“ä½œæ—¥å¿—é”™è¯¯ | æ£€æŸ¥æ—¶é—´é¡ºåº |

---

## åã€å‚è€ƒèµ„æ–™

- [HKUDS/AI-Trader](https://github.com/HKUDS/AI-Trader) - æ¶æ„å‚è€ƒ
- [yfinance](https://github.com/ranaroussi/yfinance) - è¡Œæƒ…æ•°æ®
- [FRED API](https://fred.stlouisfed.org/docs/api/fred/) - å®è§‚æ•°æ®
- [OpenCode](https://opencode.ai/docs/) - Agent æ¡†æ¶

---

*æœ¬ç³»ç»Ÿéµå¾ª"äººæœºååŒ"åŸåˆ™ï¼Œæ‰€æœ‰å»ºè®®éœ€ç»äººå·¥å¤æ ¸åæ‰§è¡Œã€‚æŠ•èµ„æœ‰é£é™©ï¼Œå…¥å¸‚éœ€è°¨æ…ã€‚*
