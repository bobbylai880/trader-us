# AI Trader Assist

> **è‡ªé€‚åº”ç¾è‚¡é‡åŒ–äº¤æ˜“ç³»ç»Ÿ** â€” åŸºäºå¸‚åœºçŠ¶æ€è¯†åˆ«çš„å¤šç­–ç•¥åˆ‡æ¢å¼•æ“ + åŠ¨æ€é€‰è‚¡

[![Python 3.12](https://img.shields.io/badge/Python-3.12-blue.svg)](https://www.python.org/)
[![PostgreSQL 18](https://img.shields.io/badge/PostgreSQL-18-336791.svg)](https://www.postgresql.org/)
[![2Y Backtest](https://img.shields.io/badge/2Y%20Return-+41.91%25-brightgreen.svg)](#å›æµ‹éªŒè¯)
[![Sharpe Ratio](https://img.shields.io/badge/Sharpe-1.57-blue.svg)](#å›æµ‹éªŒè¯)

**2å¹´å›æµ‹æˆæœ (2024-2026)**: æ”¶ç›Šç‡ **+41.91%** (vs SPY +43.07%)ï¼Œå¤æ™®æ¯”ç‡ **1.57**ï¼Œèƒœç‡ **54.1%**

---

## ç›®å½•

- [ç³»ç»Ÿç‰¹æ€§](#ç³»ç»Ÿç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [åŠ¨æ€é€‰è‚¡ç³»ç»Ÿ](#åŠ¨æ€é€‰è‚¡ç³»ç»Ÿ)
- [å›æµ‹éªŒè¯](#å›æµ‹éªŒè¯)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

---

## ç³»ç»Ÿç‰¹æ€§

### æ ¸å¿ƒèƒ½åŠ›

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **å¸‚åœºçŠ¶æ€è¯†åˆ«** | 5ç§å¸‚åœºçŠ¶æ€è‡ªåŠ¨è¯†åˆ« (ç‰›å¸‚/éœ‡è¡/ç†Šå¸‚ç­‰) |
| **ç­–ç•¥è‡ªåŠ¨åˆ‡æ¢** | æ ¹æ®å¸‚åœºçŠ¶æ€åˆ‡æ¢ä¸‰å¥—ç­–ç•¥å‚æ•° |
| **åŠ¨æ€é€‰è‚¡** | åˆ†å±‚è‚¡ç¥¨æ±  (Core/Rotation/Candidate) + æ¿å—è½®åŠ¨ |
| **PostgreSQL 18** | é«˜æ€§èƒ½æ•°æ®å­˜å‚¨ï¼Œæ”¯æŒ UUIDv7ã€VIRTUAL åˆ— |
| **LLM åˆ†æ** | DeepSeek 5é˜¶æ®µæ¨ç†æµæ°´çº¿ |

### ä¸‰å¥—è‡ªé€‚åº”ç­–ç•¥

| ç­–ç•¥ | å¸‚åœºçŠ¶æ€ | æœ€å¤§ä»“ä½ | æ­¢æŸ | ç‰¹ç‚¹ |
|------|----------|----------|------|------|
| ğŸ‚ **è¶‹åŠ¿è·Ÿè¸ª** | ç‰›å¸‚ | 95% | 15% | ç¦ç”¨æ­¢ç›ˆï¼Œè®©åˆ©æ¶¦å¥”è·‘ |
| ğŸ“Š **å‡å€¼å›å½’** | éœ‡è¡ | 60% | 8% | é«˜æŠ›ä½å¸ï¼Œå¸ƒæ—å¸¦å‡ºåœº |
| ğŸ» **é˜²å¾¡ä¿å®ˆ** | ç†Šå¸‚ | 30% | 5% | ä¸¥æ ¼æ­¢æŸï¼Œä½ä»“ä½è¿è¡Œ |

---

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-repo/trader.git
cd trader

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv .venv
source .venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ .env å¡«å…¥é…ç½®
```

**.env é…ç½®é¡¹**:

```bash
# PostgreSQL æ•°æ®åº“
PG_HOST=localhost
PG_PORT=5432
PG_DATABASE=trader
PG_USER=trader
PG_PASSWORD=your_password_here

# DeepSeek LLM
DEEPSEEK_API_KEY=your_api_key_here

# FRED å®è§‚æ•°æ® (å¯é€‰)
FRED_API_KEY=your_fred_api_key_here
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»º PostgreSQL 18 Schema
psql -h localhost -U trader -d trader -f scripts/init_pg18_schema.sql

# å¯¼å…¥å†å²æ•°æ® (3å¹´)
PYTHONPATH=. python scripts/load_historical_data.py --years 3
```

### 4. è¿è¡Œå›æµ‹

```bash
# å›ºå®šè‚¡ç¥¨æ± å›æµ‹
PYTHONPATH=. python scripts/run_backtest_2y.py

# åŠ¨æ€é€‰è‚¡å›æµ‹
PYTHONPATH=. python scripts/run_dynamic_backtest.py
```

---

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PostgreSQL 18 æ•°æ®å±‚                           â”‚
â”‚         daily_prices / indicators / sector_holdings               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                  (å‘¨é¢‘ + æ—¥é¢‘å¾®è°ƒ)
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UniverseBuilder (åŠ¨æ€é€‰è‚¡)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  Core Pool  â”‚  â”‚ Rotation    â”‚  â”‚ Candidate   â”‚              â”‚
â”‚  â”‚  (8åªå¸¸é©»)  â”‚  â”‚ Pool (18åª) â”‚  â”‚ Pool (12åª) â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MarketRegimeDetector (å¸‚åœºçŠ¶æ€è¯†åˆ«)                  â”‚
â”‚         bull_trend / range_bound / bear_trend                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AdaptiveStrategyEngine (ç­–ç•¥åˆ‡æ¢)                    â”‚
â”‚         è¶‹åŠ¿è·Ÿè¸ª / å‡å€¼å›å½’ / é˜²å¾¡ä¿å®ˆ                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PositionSizer + RiskConstraints + Report                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
trader/
â”œâ”€â”€ ai_trader_assist/           # Python æ ¸å¿ƒåŒ…
â”‚   â”œâ”€â”€ backtest/               # å›æµ‹å¼•æ“
â”‚   â”œâ”€â”€ data_collector/         # æ•°æ®é‡‡é›† (yfinance, FRED, PostgreSQL)
â”‚   â”œâ”€â”€ decision_engine/        # å†³ç­–å¼•æ“
â”‚   â”œâ”€â”€ feature_engineering/    # ç‰¹å¾å·¥ç¨‹
â”‚   â”œâ”€â”€ llm/                    # LLM å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ llm_operators/          # LLM 5é˜¶æ®µç®—å­
â”‚   â”œâ”€â”€ portfolio_manager/      # æŒä»“ç®¡ç†
â”‚   â”œâ”€â”€ position_sizer/         # ä»“ä½è®¡ç®—
â”‚   â”œâ”€â”€ risk_engine/            # é£é™©å¼•æ“
â”‚   â”œâ”€â”€ universe/               # åŠ¨æ€é€‰è‚¡æ¨¡å— (NEW)
â”‚   â””â”€â”€ jobs/                   # è°ƒåº¦è„šæœ¬
â”œâ”€â”€ configs/                    # é…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/                    # è¿è¡Œè„šæœ¬
â”‚   â”œâ”€â”€ init_pg18_schema.sql    # PostgreSQL 18 Schema
â”‚   â”œâ”€â”€ load_historical_data.py # å†å²æ•°æ®å¯¼å…¥
â”‚   â”œâ”€â”€ run_backtest_2y.py      # å›ºå®šæ± å›æµ‹
â”‚   â””â”€â”€ run_dynamic_backtest.py # åŠ¨æ€é€‰è‚¡å›æµ‹
â”œâ”€â”€ storage/                    # æ•°æ®å­˜å‚¨
â”œâ”€â”€ tests/                      # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ .env.example                # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ requirements.txt            # Python ä¾èµ–
```

---

## åŠ¨æ€é€‰è‚¡ç³»ç»Ÿ

### åˆ†å±‚è‚¡ç¥¨æ± 

| æ± ç±»å‹ | è§„æ¨¡ | æ›´æ–°é¢‘ç‡ | ä½œç”¨ |
|--------|------|----------|------|
| **Core Pool** | 8åª | å­£åº¦ | é¾™å¤´è‚¡å¸¸é©» (AAPL, MSFT, NVDA, GOOGL...) |
| **Rotation Pool** | 15-18åª | å‘¨é¢‘ | æ¿å—è½®åŠ¨ï¼Œæ•æ‰å¸‚åœºä¸»çº¿ |
| **Candidate Pool** | 10-12åª | æ—¥é¢‘ | å‘ç°æ–°å…´å¼ºåŠ¿è‚¡ |

### æ¿å—è½®åŠ¨é€»è¾‘

```python
# æ¿å—å¼ºåº¦è¯„åˆ†
sector_score = 0.5 * ret_20d + 0.3 * rs_vs_spy + 0.2 * ret_5d

# ç‰›å¸‚: Top 4 æ¿å—
# éœ‡è¡: Top 2 æ¿å—
# ç†Šå¸‚: é˜²å¾¡æ¿å—ä¼˜å…ˆ (XLP, XLV, XLU)
```

### é€‰è‚¡æ ‡å‡† (æŒ‰å¸‚åœºçŠ¶æ€)

| çŠ¶æ€ | ç­›é€‰æ¡ä»¶ |
|------|----------|
| **ç‰›å¸‚** | åŠ¨é‡ > 2%, æ”¾é‡ç¡®è®¤, ä»·æ ¼åœ¨SMA50ä¹‹ä¸Š |
| **éœ‡è¡** | RSI 30-50, è¶‹åŠ¿ç»“æ„å®Œæ•´, æ¥è¿‘å¸ƒæ—å¸¦ä¸‹æ²¿ |
| **ç†Šå¸‚** | ç›¸å¯¹å¼ºåŠ¿, ä½æ³¢åŠ¨, é˜²å¾¡æ¿å—ä¼˜å…ˆ |

---

## å›æµ‹éªŒè¯

### åŠ¨æ€é€‰è‚¡ vs å›ºå®šæ± å¯¹æ¯” (2024-01 ~ 2026-01)

| æŒ‡æ ‡ | åŠ¨æ€é€‰è‚¡ | å›ºå®šæ±  | å·®å¼‚ |
|------|----------|--------|------|
| **æ€»æ”¶ç›Šç‡** | **+41.91%** | +30.86% | **+11.05%** âœ… |
| **å¹´åŒ–æ”¶ç›Š** | **+19.20%** | +14.45% | +4.75% |
| **å¤æ™®æ¯”ç‡** | **1.57** | 1.34 | +0.23 |
| **èƒœç‡** | **54.1%** | 47.5% | +6.6% |
| **æœ€å¤§å›æ’¤** | 12.71% | 10.03% | +2.68% |
| **SPYæ”¶ç›Š** | +43.07% | +43.07% | - |

### äº¤æ˜“æ¥æºåˆ†å¸ƒ

| æ± ç±»å‹ | å æ¯” | è¯´æ˜ |
|--------|------|------|
| **Core (æ ¸å¿ƒæ± )** | 60.6% | é¾™å¤´è‚¡ç¨³å®šè´¡çŒ® |
| **Candidate (è§‚å¯Ÿæ± )** | 24.2% | æ–°å…´å¼ºåŠ¿è‚¡ |
| **Rotation (è½®åŠ¨æ± )** | 15.2% | æ¿å—è½®åŠ¨æ•æ‰ |

### æœ€å¤§ç›ˆåˆ©äº¤æ˜“

| æ—¥æœŸ | è‚¡ç¥¨ | æ¥æº | ç›ˆäº | æ”¶ç›Šç‡ |
|------|------|------|------|--------|
| 2025-11-18 | GOOGL | Core | **+$10,660** | +84.3% |
| 2024-04-17 | NVDA | Core | +$5,806 | +36.4% |
| 2025-11-18 | AAPL | Core | +$5,341 | +30.7% |
| 2024-08-28 | SBUX | Candidate | +$4,988 | +23.7% |

---

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ (.env)

```bash
# PostgreSQL æ•°æ®åº“
PG_HOST=localhost
PG_PORT=5432
PG_DATABASE=trader
PG_USER=trader
PG_PASSWORD=your_password_here

# DeepSeek LLM
DEEPSEEK_API_KEY=your_api_key_here
DEEPSEEK_MODEL=deepseek-chat
DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions
DEEPSEEK_TIMEOUT=90
DEEPSEEK_MAX_TOKENS=8192

# FRED å®è§‚æ•°æ® (å¯é€‰)
FRED_API_KEY=your_fred_api_key_here

# æ—¶åŒº
TZ=America/Los_Angeles
```

### æ ¸å¿ƒé…ç½® (configs/base.json)

```json
{
  "universe": {
    "indices": ["SPY", "QQQ", "DIA", "IWM"],
    "sectors": ["XLK", "XLF", "XLV", "XLE", "XLY", "XLP", "XLI", "XLB", "XLU", "XLRE", "XLC"],
    "watchlist": ["NVDA", "AAPL", "MSFT", "AMZN", "META", "AMD", "GOOGL", "TSLA"]
  },
  "limits": {
    "max_exposure": 0.95,
    "max_single_weight": 0.40,
    "min_ticket": 1000
  }
}
```

---

## å¼€å‘æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests -q

# æµ‹è¯• UniverseBuilder
PYTHONPATH=. python scripts/test_universe_builder.py
```

### æ·»åŠ æ–°ç­–ç•¥

```python
# åœ¨ ai_trader_assist/backtest/regime_strategies.py ä¸­æ·»åŠ 
NEW_STRATEGY = StrategyConfig(
    mode=StrategyMode.NEW_MODE,
    max_exposure=0.70,
    # ... å…¶ä»–å‚æ•°
)
```

### æ‰©å±•é€‰è‚¡é€»è¾‘

```python
# åœ¨ ai_trader_assist/universe/builder.py ä¸­ä¿®æ”¹
def _build_fast_universe(self, trade_date, regime):
    # æ·»åŠ è‡ªå®šä¹‰ç­›é€‰é€»è¾‘
    ...
```

---

## å…è´£å£°æ˜

âš ï¸ **æœ¬é¡¹ç›®ä»…ç”¨äºç ”ç©¶ä¸æ•™å­¦ï¼Œä¸è¿æ¥ä»»ä½•åˆ¸å•†ç³»ç»Ÿï¼Œä¸æ„æˆæŠ•èµ„å»ºè®®ã€‚**

- å›æµ‹ç»“æœä¸ä»£è¡¨æœªæ¥æ”¶ç›Š
- å®ç›˜äº¤æ˜“éœ€è€ƒè™‘æ»‘ç‚¹ã€æ‰‹ç»­è´¹ã€æµåŠ¨æ€§ç­‰å› ç´ 
- è¯·åœ¨äººå·¥å¤æ ¸åæ‰§è¡Œæ‰€æœ‰äº¤æ˜“
- æŠ•èµ„æœ‰é£é™©ï¼Œå…¥å¸‚éœ€è°¨æ…

---

## å‚è€ƒèµ„æ–™

- [HKUDS/AI-Trader](https://github.com/HKUDS/AI-Trader) - æ¶æ„å‚è€ƒ
- [yfinance](https://github.com/ranaroussi/yfinance) - è¡Œæƒ…æ•°æ®
- [FRED API](https://fred.stlouisfed.org/docs/api/fred/) - å®è§‚æ•°æ®
- [PostgreSQL 18](https://www.postgresql.org/docs/18/) - æ•°æ®åº“

---

*Built with Python. Powered by Data. Guided by Discipline.*
